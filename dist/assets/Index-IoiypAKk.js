import{k as N,a as D,r as T,E as x,d as i,o as j,h as J,w as l,b as e,q as K,s as P,v as Q,c as X,e as L,F as Y,u as v,f as b,x as Z,y as ee,m as te,z as M,A as ae,B as le,C as oe,D as ne}from"./index-CgjYOObe.js";import{d as re,u as se,a as de,b as ie}from"./apis-BdUsWhz8.js";const y="140px",ue={__name:"UserForm",props:{formData:{type:Object}},emits:["returnSuccess"],setup(n,{expose:S,emit:g}){const d=n,u=g;N(()=>{z()});const h=D(),U=T({username:[{required:!0,message:"请填写用户姓名",trigger:"change"}],sex:[{required:!0,message:"请填写性别",trigger:"change"}],birthday:[{required:!0,message:"请填写生日",trigger:"change"}],age:[{required:!0,message:"请填写年龄",trigger:"change"}],department:[{required:!0,message:"请选择部门",trigger:"change"}],email:[{required:!0,message:"请填写邮箱",trigger:"change"}],address:[{required:!0,message:"请填写居住地址",trigger:"change"}]}),F=s=>{s&&(d.formData.age=K(s))},_=D([]),z=()=>{re().then(s=>{s.data?_.value=s.data.data.departmentSelectData:x.error("服务器内部错误")})};return S({onSubmit:()=>{h.value.validate(async s=>{if(s)try{d.formData.id?se(d.formData).then(a=>{console.log("编辑数据成功"),console.log(x),x({message:"编辑用户成功",type:"success"}),u("returnSuccess",a.data.data)}):(d.formData.birthday=P(d.formData.birthday),d.formData.date=Q("day"),d.formData.isValid=!0,de(d.formData).then(a=>{x({message:"添加用户成功",type:"success"}),d.formData.id=a.data.data.id,u("returnSuccess",a.data.data)}).catch(a=>{}))}catch(a){console.log(a)}})}}),(s,a)=>{const w=i("el-input"),m=i("el-form-item"),B=i("el-date-picker"),q=i("el-input-number"),E=i("el-switch"),k=i("el-form");return j(),J(k,{model:n.formData,rules:U,ref_key:"FormRef",ref:h,class:"demo-ruleForm"},{default:l(()=>[e(m,{label:"品牌名称","label-width":y,prop:"username"},{default:l(()=>[e(w,{modelValue:n.formData.username,"onUpdate:modelValue":a[0]||(a[0]=r=>n.formData.username=r),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(m,{label:"成立日期","label-width":y,prop:"birthday"},{default:l(()=>[e(B,{modelValue:n.formData.birthday,"onUpdate:modelValue":a[1]||(a[1]=r=>n.formData.birthday=r),type:"date",placeholder:"请选择日期",onChange:F},null,8,["modelValue"])]),_:1}),e(m,{label:"经营年份","label-width":y,prop:"age"},{default:l(()=>[e(q,{modelValue:n.formData.age,"onUpdate:modelValue":a[2]||(a[2]=r=>n.formData.age=r),min:1,max:150},null,8,["modelValue"])]),_:1}),e(m,{label:"官网","label-width":y,prop:"email"},{default:l(()=>[e(w,{modelValue:n.formData.email,"onUpdate:modelValue":a[3]||(a[3]=r=>n.formData.email=r),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(m,{label:"地址","label-width":y,prop:"address"},{default:l(()=>[e(w,{modelValue:n.formData.address,"onUpdate:modelValue":a[4]||(a[4]=r=>n.formData.address=r),type:"textarea"},null,8,["modelValue"])]),_:1}),e(m,{label:"产品定位","label-width":y,prop:"work"},{default:l(()=>[e(w,{modelValue:n.formData.content,"onUpdate:modelValue":a[5]||(a[5]=r=>n.formData.content=r),type:"textarea"},null,8,["modelValue"])]),_:1}),e(m,{label:"宣传标语","label-width":y,prop:"hobby"},{default:l(()=>[e(w,{modelValue:n.formData.content,"onUpdate:modelValue":a[6]||(a[6]=r=>n.formData.content=r),type:"textarea"},null,8,["modelValue"])]),_:1}),e(m,{label:"是否启用","label-width":y,prop:"isValid"},{default:l(()=>[e(E,{modelValue:n.formData.isValid,"onUpdate:modelValue":a[7]||(a[7]=r=>n.formData.isValid=r)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])}}},me={class:"dialog-footer"},ce={__name:"Index",setup(n){const S=te();N(()=>{h()});let g=D([]),d=D(0);const u=T({page:1,size:10,username:""}),h=()=>{ie(u).then(o=>{o.data?(console.log(o),g.value=o.data.data.userList,d.value=o.data.data.total):x.error("服务器内部错误")})},U=()=>{u.page=1,h()},F=()=>{u.username="",h()},_=o=>{u.size=o,h()},z=o=>{u.page=o,h()},V=D(!1),s=T({title:"添加",FormData:{}}),a=()=>{s.FormData={username:"",birthday:"",age:"",sex:1,department:"",email:"",work:"",address:"",content:"",isValid:!0},V.value=!0},w=o=>{V.value=!0,s.FormData=o,console.log("edit==",s.FormData),s.isView=!1,s.title="编辑"},m=D(),B=()=>{m.value.onSubmit()},q=o=>{g.value=o,V.value=!1},E=o=>{M.confirm("确定要删除该品牌信息吗?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{g.value.splice(o,1),d.value=g.value.length}).catch(()=>{x({type:"info",message:"取消删除"})})},k=D(!1),r=D([]),A=o=>{o.length>0?k.value=!0:k.value=!1,o.forEach(t=>{const C=t.id;r.value.indexOf(C)==-1&&r.value.push(C)})},O=()=>{M.confirm("确定要删除选中用户信息吗?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r.value.filter((o,t)=>{g.value.forEach((C,f)=>{o==C.id&&g.value.splice(f,1)})}),d.value=g.value.length}).catch(()=>{x({type:"info",message:"取消删除"})})};return(o,t)=>{const C=i("el-input"),f=i("el-button"),$=i("el-card"),p=i("el-table-column"),I=i("el-switch"),W=i("el-table"),G=i("el-pagination"),H=i("el-dialog");return j(),X(Y,null,[L("div",null,[e($,null,{default:l(()=>[e(C,{style:{width:"440px"},modelValue:u.username,"onUpdate:modelValue":t[0]||(t[0]=c=>u.username=c),placeholder:"请输入品牌名称",class:"input-with-select"},null,8,["modelValue"]),e(f,{type:"primary",icon:v(ae),onClick:U,class:"ml20"},{default:l(()=>t[5]||(t[5]=[b("搜索")])),_:1},8,["icon"]),e(f,{type:"primary",icon:v(le),onClick:F,class:"ml20"},{default:l(()=>t[6]||(t[6]=[b("重置")])),_:1},8,["icon"])]),_:1}),e($,null,{default:l(()=>[e(f,{type:"primary",icon:v(oe),onClick:a},{default:l(()=>t[7]||(t[7]=[b("添加")])),_:1},8,["icon"]),Z(e(f,{type:"primary",icon:v(ne),onClick:O},{default:l(()=>t[8]||(t[8]=[b("批量删除")])),_:1},8,["icon"]),[[ee,k.value]]),e(W,{data:v(g),border:"",style:{width:"100%","margin-top":"20px"},onSelectionChange:A},{default:l(()=>[e(p,{type:"selection",width:"55"}),e(p,{prop:"username",label:"品牌名称",width:"100"}),e(p,{prop:"age",label:"经营年份",width:"110",sortable:""}),e(p,{prop:"email",label:"官网",width:"180"}),e(p,{prop:"birthday",label:"成立日期",width:"110",sortable:""}),e(p,{prop:"work",label:"产品定位",width:"180"}),e(p,{prop:"address",label:"地址",width:"150"}),e(p,{prop:"hobby",label:"宣传标语",width:"260"}),e(p,{prop:"date",label:"创建日期",width:"110",sortable:""}),e(p,{prop:"isValid",label:"是否启用",width:"100"},{default:l(c=>[e(I,{modelValue:c.row.isValid,"onUpdate:modelValue":R=>c.row.isValid=R,width:"10px"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{label:"操作",width:"330"},{default:l(c=>[e(f,{type:"info",size:"small",onClick:()=>v(S).push({path:"/user/detail",query:{id:c.row.id}})},{default:l(()=>t[9]||(t[9]=[b(" 详情 ")])),_:2},1032,["onClick"]),e(f,{type:"primary",size:"small",onClick:R=>w(c.row)},{default:l(()=>t[10]||(t[10]=[b("编辑")])),_:2},1032,["onClick"]),e(f,{type:"danger",size:"small",onClick:t[1]||(t[1]=R=>E(o.index))},{default:l(()=>t[11]||(t[11]=[b("删除")])),_:1})]),_:1})]),_:1},8,["data"]),e(G,{style:{"margin-top":"20px"},"current-page":u.page,"page-size":u.size,"page-sizes":[10,20,30,40],layout:"->,total, sizes, prev, pager, next, jumper",total:v(d),onSizeChange:_,onCurrentChange:z},null,8,["current-page","page-size","total"])]),_:1})]),e(H,{modelValue:V.value,"onUpdate:modelValue":t[4]||(t[4]=c=>V.value=c),title:`${s.title}品牌`,draggable:"true"},{footer:l(()=>[L("span",me,[e(f,{onClick:t[2]||(t[2]=c=>V.value=!1)},{default:l(()=>t[12]||(t[12]=[b("取消")])),_:1}),e(f,{type:"primary",onClick:t[3]||(t[3]=c=>B())},{default:l(()=>t[13]||(t[13]=[b("确认")])),_:1})])]),default:l(()=>[e(ue,{ref_key:"formRef",ref:m,formData:s.FormData,onReturnSuccess:q},null,8,["formData"])]),_:1},8,["modelValue","title"])],64)}}};export{ce as default};
