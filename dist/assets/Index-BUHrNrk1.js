import{k as E,a as p,r as F,d,o as G,h as I,w as o,b as e,E as y,v as W,c as A,e as j,F as H,u as C,f as g,x as J,y as K,m as P,z as q,C as Q,D as X}from"./index-CgjYOObe.js";import{f as Y,h as Z,i as ee}from"./apis-BdUsWhz8.js";const V="140px",te={__name:"GradeForm",props:{formData:{type:Object}},emits:["returnSuccess"],setup(r,{expose:_,emit:s}){const i=r,c=s;E(()=>{});const b=p(),x=F({name:[{required:!0,message:"请填写姓名",trigger:"change"}],sex:[{required:!0,message:"请填写性别",trigger:"change"}],date:[{required:!0,message:"请填写日期",trigger:"change"}],subject:[{required:!0,message:"请填写学科",trigger:"change"}],type:[{required:!0,message:"请选择成绩类型",trigger:"change"}],grade:[{required:!0,message:"请填写成绩",trigger:"change"}]});return _({onSubmit:()=>{b.value.validate(async u=>{if(u)try{i.formData.id?Y(i.formData).then(a=>{console.log("编辑数据成功"),console.log(y),y({message:"编辑成绩信息成功",type:"success"}),c("returnSuccess",a.data.data)}):(i.formData.date=W("day"),Z(i.formData).then(a=>{y({message:"添加成绩信息成功",type:"success"}),i.formData.id=a.data.data.id,c("returnSuccess",a.data.data)}).catch(a=>{}))}catch(a){console.log(a)}})}}),(u,a)=>{const D=d("el-input"),v=d("el-form-item"),w=d("el-date-picker"),k=d("el-form");return G(),I(k,{model:r.formData,rules:x,ref_key:"FormRef",ref:b,class:"demo-ruleForm"},{default:o(()=>[e(v,{label:"系列名","label-width":V,prop:"name"},{default:o(()=>[e(D,{modelValue:r.formData.name,"onUpdate:modelValue":a[0]||(a[0]=m=>r.formData.name=m),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(v,{label:"推出日期","label-width":V,prop:"date"},{default:o(()=>[e(w,{modelValue:r.formData.date,"onUpdate:modelValue":a[1]||(a[1]=m=>r.formData.date=m),type:"date",placeholder:"请选择日期",onChange:u.handleDateChange},null,8,["modelValue","onChange"])]),_:1}),e(v,{label:"品牌","label-width":V,prop:"subject"},{default:o(()=>[e(D,{modelValue:r.formData.subject,"onUpdate:modelValue":a[2]||(a[2]=m=>r.formData.subject=m),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(v,{label:"价格","label-width":V,prop:"grade"},{default:o(()=>[e(D,{modelValue:r.formData.grade,"onUpdate:modelValue":a[3]||(a[3]=m=>r.formData.grade=m),type:"number"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])}}},ae={class:"dialog-footer"},ne={__name:"Index",setup(r){const _=P();E(()=>{b()});let s=p([]),i=p(0);const c=F({page:1,size:10,username:""}),b=()=>{ee(c).then(l=>{l.data?(console.log(l),s.value=l.data.data.gradeList,i.value=l.data.data.total):y.error("服务器内部错误")})},x=l=>{c.size=l,b()},B=l=>{c.page=l,b()},u=p(!1),a=F({title:"添加",FormData:{}}),D=()=>{a.FormData={username:"",birthday:"",age:"",sex:1,department:"",email:"",work:"",address:"",content:"",isValid:!0},u.value=!0},v=l=>{u.value=!0,a.FormData=l,console.log("edit==",a.FormData),a.isView=!1,a.title="编辑"},w=p(),k=()=>{w.value.onSubmit()},m=l=>{s.value=l,u.value=!1},R=l=>{q.confirm("确定要删除该系列信息吗?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{s.value.splice(l,1),i.value=s.value.length}).catch(()=>{y({type:"info",message:"取消删除"})})},S=p(!1),z=p([]),T=l=>{l.length>0?S.value=!0:S.value=!1,l.forEach(t=>{const n=t.id;z.value.indexOf(n)==-1&&z.value.push(n)})},U=()=>{q.confirm("确定要删除选中的成绩信息吗?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{z.value.filter((l,t)=>{s.value.forEach((n,f)=>{l==n.id&&s.value.splice(f,1)})}),i.value=s.value.length}).catch(()=>{y({type:"info",message:"取消删除"})})};return(l,t)=>{const n=d("el-button"),f=d("el-table-column"),$=d("el-table"),L=d("el-pagination"),M=d("el-card"),N=d("el-dialog");return G(),A(H,null,[j("div",null,[e(M,null,{default:o(()=>[e(n,{type:"primary",icon:C(Q),onClick:D},{default:o(()=>t[4]||(t[4]=[g("添加")])),_:1},8,["icon"]),J(e(n,{type:"primary",icon:C(X),onClick:U},{default:o(()=>t[5]||(t[5]=[g("批量删除")])),_:1},8,["icon"]),[[K,S.value]]),e($,{data:C(s),border:"",style:{width:"100%","margin-top":"20px"},onSelectionChange:T},{default:o(()=>[e(f,{type:"selection",width:"55"}),e(f,{prop:"name",label:"产品名称",width:"150"}),e(f,{prop:"date",label:"推出日期",width:"110",sortable:""}),e(f,{prop:"subject",label:"品牌名称",width:"150"}),e(f,{prop:"grade",label:"售价",width:"100"}),e(f,{label:"操作",width:"256"},{default:o(h=>[e(n,{type:"info",size:"small",onClick:()=>C(_).push({path:"/grade/detail",query:{id:h.row.id}})},{default:o(()=>t[6]||(t[6]=[g(" 详情 ")])),_:2},1032,["onClick"]),e(n,{type:"primary",size:"small",onClick:O=>v(h.row)},{default:o(()=>t[7]||(t[7]=[g("编辑")])),_:2},1032,["onClick"]),e(n,{type:"danger",size:"small",onClick:t[0]||(t[0]=O=>R(l.index))},{default:o(()=>t[8]||(t[8]=[g("删除")])),_:1})]),_:1})]),_:1},8,["data"]),e(L,{style:{"margin-top":"20px"},"current-page":c.page,"page-size":c.size,"page-sizes":[10,20,30,40],layout:"->,total, sizes, prev, pager, next, jumper",total:C(i),onSizeChange:x,onCurrentChange:B},null,8,["current-page","page-size","total"])]),_:1})]),e(N,{modelValue:u.value,"onUpdate:modelValue":t[3]||(t[3]=h=>u.value=h),title:`${a.title}系列`,draggable:"true"},{footer:o(()=>[j("span",ae,[e(n,{onClick:t[1]||(t[1]=h=>u.value=!1)},{default:o(()=>t[9]||(t[9]=[g("取消")])),_:1}),e(n,{type:"primary",onClick:t[2]||(t[2]=h=>k())},{default:o(()=>t[10]||(t[10]=[g("确认")])),_:1})])]),default:o(()=>[e(te,{ref_key:"formRef",ref:w,formData:a.FormData,onReturnSuccess:m},null,8,["formData"])]),_:1},8,["modelValue","title"])],64)}}};export{ne as default};
